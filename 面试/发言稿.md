各位好，之前我们学习了防火墙相关的基础知识，今天我们来继续学习“防火墙技术”，其中主要包括包过滤防火墙也叫分组过滤路由器，应用级网关，以及它们的结合使用。  
包过滤防火墙又被称为分组过滤路由器或者叫做网络级防火墙。其中又能被分为简单包过滤（静态包过滤）和状态检测（动态包过滤）。今天我们主要学习简单包过滤。该类防火墙运行在TCP、IP协议的网络层上，如右图所示该防火墙中有过滤规则，而过滤判断主要是IP头和TCP头。防火墙会对进出内部网络的所有信息进行分析并进行过滤，符合的通过，否则丢弃。  
包过滤防火墙的工作原理，通过事先定义的过滤规则来对数据包进行审查。检查的内容为源目的IP地址，源目的端口号，协议类型，TCP报头的标志位比如ACK位。  
看它的工作流程，数据包进来后，先看是否有过滤规则，没有的话，防火墙和路由器一样直接将数据包送走，有的话就和防火墙里的过滤规则表中的过滤规则逐一匹配，一旦匹配成功，就按照该规则的指引进行操作，后续不再和后面规则匹配，若都没有匹配到，则按照默认拒绝的规则进行拒绝。根据工作原理和工作流程，总结了两条特点。  
下面是一个实例，某个企业内网通过防火墙与外部网络互连，它的安全需求有如下三条，需要根据上面三条填写过滤安全规则表。与1号需求相对应的是规则表中的1、2条，先看第一条，源地址是101.125.63.0正是企业内部网的数据包，源端口是1024到65535之间临时启用一个进行通信，目标地址任意，端口号80，对应的是HTTP服务，动作是accept允许，也就是说允许企业内网的数据包可以访问任意外部网络的网页服务器。相应外网也会有信息回送回来，第二条就是允许外网的数据包通行的。和第一条相反。所以1,2条满足了第一条需求。看需求2，外部用户也可以访问企业内网的网页服务器，那么和规则1,2一样，我们看3，4条，原理和上面1,2条一样。第三条中源地址任意表示任意外网，源端口是1024到65535之间临时启用一个进行通信，目的地址101.125.64.125内网服务器地址，端口80HTTP服务，动作是accept运行，表示允许任意外网可以通过防火墙访问内网服务器，而第四条和第三条相反，两个组成了需求2的安全规则。看需求3，源地址任意，目的地址任意，动作是drop。那么这样就写好了我们的过滤安全规则表。  
下面总结下包过滤防火墙的优缺点。  

应用级网关也叫代理服务器，可以提供两个网络之间传输的高水平控制，这两个网络就是我们所说的信任网络和非信任网络。应用级网关在两个网络的通信中扮演消息传递者的角色，能提供监控和基于安全策略的过滤。  
下面我们看进一步的分析，内网客户机向外网服务器发送请求先发送到代理服务器，这时代理服务器接收请求，扮演的是服务器的角色，然后将请求转发给外网服务器，这时代理服务器扮演的是客户机的角色。外网服务器回复信息也是通过代理服务器中转。从这里可以看出代理服务器是一个中转者和传递者的角色，此外代理服务器还能实现数据过滤和用户鉴别的功能。  
下面看下应用级网关的结构。  
这个结构基于功能来说的，内部有两个主要的功能模块，服务器代理模块和客户代理模块。客户机要访问外部服务器，那么发送的请求先发送到服务器代理模块，然后到客户代理模块，最后转发到服务器。这个过程是双向的。这个叫做正向代理。另外，如果在安全网络中放一台服务器，外网的客户机来进行请求，这时我们的应用级网关就作为我们真实服务器的替身，外网客户机的请求先被替身接收到，然后中转到真正的服务器中。这叫反向代理。  
下面总结下应用级网关的优缺点。  
上面讲了包过滤防火墙和应用级网关，大家也对这两种防火墙技术有了一些了解，最后我们提一下两种技术的结合使用。  
以上是今天的课程内容，谢谢大家。  